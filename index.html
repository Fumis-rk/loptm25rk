<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ranking Liga Oeste Paulista de T√™nis de Mesa 2025</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body class="bg-gray-100 text-gray-900 flex flex-col min-h-screen">
  <div id="root" class="flex-grow"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
      const [data, setData] = useState([]);
      const [categorias, setCategorias] = useState([]);
      const [categoriaSelecionada, setCategoriaSelecionada] = useState("");
      const [atletaSelecionado, setAtletaSelecionado] = useState(null);

      useEffect(() => {
        Papa.parse("rankingloptm.csv", {
          download: true,
          header: true,
          complete: (results) => {
            const rows = results.data.filter(row => row["Nome"]);
            setData(rows);
            const cats = [...new Set(rows.map(row => row["Categoria/Classe"]).filter(Boolean))];
            setCategorias(cats.sort());
          },
        });
      }, []);

      const parseNum = (v) => {
        if (v == null) return 0;
        let s = String(v).trim();
        if (s === "") return 0;
        s = s.replace(/\./g, '').replace(',', '.');
        const n = parseFloat(s);
        return isNaN(n) ? 0 : n;
      };

      const atletas = data.filter(d => d["Categoria/Classe"] === categoriaSelecionada);

      return (
        <div className="container mx-auto p-4 flex flex-col">

          {/* Logo e t√≠tulo */}
          <img src="logo.png" alt="Logo LOPTM" className="block mx-auto h-24 mb-4" />
          <h1 className="text-3xl font-bold text-blue-700 mb-2 text-center">Ranking LOPTM 2025</h1>
          <p className="text-gray-700 text-center mt-2 mb-4">Clique no nome do atleta para mais detalhes</p>

          {/* Se√ß√£o de download de PDFs */}
          <div class="mb-8">
            <h2 className="text-xl font-bold mb-4 text-center">Baixe os resultados da etapa</h2>

            {/* Ranking completo */}
            <div className="flex justify-center mb-6">
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Ranking_Completo.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-6 rounded-lg shadow">
                üìÑ Ranking Completo em PDF
              </a>
            </div>

            {/* Bot√µes das etapas, responsivos */}
            <div className="flex flex-wrap justify-center gap-4">
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa1_Marilia.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 1 - Mar√≠lia</a>
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa2_Assis.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 2 - Assis</a>
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa3_Ourinhos.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 3 - Ourinhos</a>
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa4_Aracatuba.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 4 - Ara√ßatuba</a>
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa5_SJRioPreto.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 5 - S.J.Rio Preto</a>
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa6_Birigui.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 6 - Birigui</a>
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa7_Bauru.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 7 - Bauru</a>
              <a href="https://github.com/Fumis-rk/loptm25rk/raw/main/Etapa8_PresPrudente.pdf" target="_blank"
                 className="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto text-center">Etapa 8 - Pres. Prudente</a>
            </div>
          </div>

          {/* Sele√ß√£o de categoria */}
          <div className="mb-6 flex justify-center">
            <select
              className="p-2 border rounded-lg shadow"
              value={categoriaSelecionada}
              onChange={(e)=>{setCategoriaSelecionada(e.target.value); setAtletaSelecionado(null);}}
            >
              <option value="">Selecione uma Categoria</option>
              {categorias.map((c,i)=>(<option key={i} value={c}>{c}</option>))}
            </select>
          </div>

          {/* Tabela de atletas */}
          {categoriaSelecionada && !atletaSelecionado && (
            <table className="min-w-full bg-white rounded-lg shadow overflow-hidden">
              <thead className="bg-blue-700 text-white">
                <tr>
                  <th className="py-2 px-4">#</th>
                  <th className="py-2 px-4">Nome</th>
                  <th className="py-2 px-4">Equipe</th>
                  <th className="py-2 px-4">Categoria</th>
                  <th className="py-2 px-4">Pontos</th>
                </tr>
              </thead>
              <tbody>
                {atletas.sort((a,b)=>parseNum(b["Pontos"])-parseNum(a["Pontos"])).map((atleta,index)=>(
                  <tr key={index} className="border-b hover:bg-gray-100 cursor-pointer" onClick={()=>setAtletaSelecionado(atleta)}>
                    <td className="py-2 px-4">{index+1}</td>
                    <td className="py-2 px-4">{atleta["Nome"]}</td>
                    <td className="py-2 px-4">{atleta["Equipe"]}</td>
                    <td className="py-2 px-4">{atleta["Categoria/Classe"]}</td>
                    <td className="py-2 px-4">{atleta["Pontos"]}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          )}

          {/* Detalhes do atleta */}
          {atletaSelecionado && (
            <div className="bg-white p-6 rounded-lg shadow mt-6">
              <button className="mb-4 px-4 py-2 bg-gray-300 rounded" onClick={()=>setAtletaSelecionado(null)}>‚Üê Voltar</button>
              <h2 className="text-2xl font-bold text-blue-700 mb-2">{atletaSelecionado["Nome"]}</h2>
              <p className="text-gray-700 mb-2"><b>Equipe:</b> {atletaSelecionado["Equipe"]}</p>
              <p className="text-gray-700 mb-2"><b>Categoria:</b> {atletaSelecionado["Categoria/Classe"]}</p>
              <p className="text-lg font-bold text-gray-900 mb-4">Total de Pontos: {atletaSelecionado["Pontos"]}</p>

              <h3 className="text-xl font-semibold mb-2">Etapas</h3>
              <ul className="list-disc ml-6">
                {Object.keys(atletaSelecionado).filter(k=>k.startsWith("Etapa")||k.includes("ETAPA")).map((etapa,i)=>(
                  <li key={i}>{etapa}: {atletaSelecionado[etapa]||0}</li>
                ))}
              </ul>
            </div>
          )}

        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
